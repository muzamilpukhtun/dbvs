generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int      @id @default(autoincrement())
  arid      Int      @unique
  name      String
  password  Int
  createdAt DateTime @default(now())
}


model Poll {
  id        Int       @id @default(autoincrement())
  name      String
  endDate   DateTime
  createdAt DateTime  @default(now())
  createdBy String    // <- Add this to link with user (like arid or email)
  options   Option[]
}


model Option {
  id      Int    @id @default(autoincrement())
  text    String
  votes   Int    @default(0)
  poll    Poll   @relation(fields: [pollId], references: [id])
  pollId  Int
}


model Vote {
  id        Int      @id @default(autoincrement())
  pollId    Int
  optionId  Int
  voterId   String   // Can be wallet address or user ID
  txHash    String   @unique
  status    String   @default("PENDING") // PENDING, CONFIRMED, FAILED
  createdAt DateTime @default(now())

  @@index([pollId])
  @@index([voterId])
}

model PendingVote {
  id       Int    @id @default(autoincrement())
  pollId   Int
  optionId Int
  voterId  String
  txData   Json   // Raw transaction data
}
